---
breadcrumb: Pivotal Cloud Foundry Documentation
title: Configuring TCP Routing in PAS
owner: Routing
---

This topic describes how to enable the TCP routing feature in a <%= vars.product_runtime %> (<%= vars.product_short %>) deployment.

<p class='note breaking'><strong>Breaking Change:</strong> If you have mutual TLS app identity verification enabled, Envoy only recognizes communications from the Gorouter. Therefore, TCP no longer works.</p>


## <a id="overview"></a> Overview

TCP routing enables apps that require inbound requests on non-HTTP protocols to run on <%= vars.product_name %>.


## <a id="prerequisite"></a> Prerequisite

Before enabling TCP routing, review the pre-deployment steps that describe required networking infrastructure changes. For more information, see the [Pre-Deployment Steps](../adminguide/enabling-tcp-routing.html#pre-deploy) section of the _Enabling TCP Routing_ topic.


## <a id="enable-tcp"></a> Enable TCP Routing

TCP routing is disabled by default.

To enable TCP routing:

1. Go to the **Networking** pane of the PAS tile.

1. Under **Enable TCP requests to apps through specific ports on the TCP router**, select **Enable TCP Routing**.
    <p class='note'><strong>Note:</strong> If you have mutual TLS app identity verification enabled, app containers accept incoming communication only from the Gorouter. This disables TCP routing.</p>

1. For **TCP Routing Ports**, enter one or more ports to which the load balancer forwards requests. To support multiple TCP routes, Pivotal recommends allocating multiple ports. Do one of the following:
    * To allocate a single port or range of ports, enter a single port or a range of ports.  
    	<p class="note"><strong>Note:</strong> If you configured AWS for <%= vars.product_name %> manually, enter <code>1024-1123</code> which corresponds to the rules you created for <code><%= vars.product_name_lc %>-tcp-elb</code>.</p>
    * To allocate a list of ports:
    	1. Enter a single port in the **TCP routing ports** field.
    	1. After deploying <%= vars.product_short %>, follow the procedure in the [Configuring a List of TCP Routing Ports](https://docs.pivotal.io/pivotalcf/2-3/pcf-release-notes/runtime-rn.html#tcp-port-config) section of the _<%= vars.product_runtime %> v2.3 Release Notes_ topic to add TCP routing ports using the cf CLI.

1. (Optional) For **TCP request timeout**, modify the default value of 300 seconds. This field determines when the TCP router closes idle connections from clients to apps that use TCP routes. You may want to increase this value to enable developers to push apps that require long-running idle connections with clients.

1. Follow these additional instructions based on your IaaS:
    <table>
    	<tr>
   			<th>IaaS</th>
   	   		<th>Instructions</th>
      	</tr>
      	<tr>
   	   		<td>GCP</td>
   	   		<td>Specify the name of a GCP TCP load balancer in the <strong>LOAD BALANCER</strong> field of the <strong>TCP Router</strong> job in the <strong>Resource Config</strong> pane. You configure this later on in PAS. For more information, see <a href="../customizing/configure-lb.html">Configuring Load Balancing for <%= vars.product_short %></a>.</td>
      	</tr>
      	<tr>
   	   		<td>AWS</td>
   	   		<td>Specify the name of a TCP ELB in the <strong>LOAD BALANCER</strong> field of the <strong>TCP Router</strong> job in the <strong>Resource Config</strong> pane. You configure this later on in PAS. For more information, see <a href="../customizing/configure-lb.html">Configuring Load Balancing for <%= vars.product_short %></a>.</td>
      	</tr>
      	<tr>
   	   		<td>Azure</td>
   	   		<td>Specify the name of a Azure load balancer in the <strong>LOAD BALANCER</strong> field of the <strong>TCP Router</strong> job in the <strong>Resource Config</strong> pane. You configure this later on in PAS. For more information, see <a href="../customizing/configure-lb.html">Configuring Load Balancing for <%= vars.product_short %></a>.</td>
      	</tr>
      	<tr>
   	   		<td>OpenStack and vSphere</td>
   	   		<td>
            	<ol>
   	   		   		<li> Return to the top of the <strong>Networking</strong> pane.</li>
                  	<li>In the <strong>TCP router IPs</strong> field, ensure that you have entered IP addresses that are within your subnet CIDR block. These are the same IP addresses you configured your load balancer with in the <a href="../adminguide/enabling-tcp-routing.html#pre-deploy">Pre-Deployment Steps</a> section of the <em>Enabling TCP Routing</em> topic, unless you configured DNS to resolve the TCP domain name directly to an IP you have chosen for the TCP router.</li>
               	</ol>
   	   		</td>
      	</tr>
    </table>


## <a id="disable-tcp"></a> Disable TCP Routing

To disable TCP routing:

1. In the **Networking** pane of the <%= vars.product_short %> tile, under **Enable TCP requests to apps through specific ports on the TCP Router...**, click **Select this option if you prefer to enable TCP Routing at a later time**.

1. Manually remove the TCP routing domain.
